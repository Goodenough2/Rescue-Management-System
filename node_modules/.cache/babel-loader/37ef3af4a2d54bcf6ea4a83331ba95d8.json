{"remainingRequest":"C:\\Users\\Neal Wang\\IdeaProjects\\rescue_web\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Neal Wang\\IdeaProjects\\rescue_web\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\Neal Wang\\IdeaProjects\\rescue_web\\src\\store\\modules\\account.js","dependencies":[{"path":"C:\\Users\\Neal Wang\\IdeaProjects\\rescue_web\\src\\store\\modules\\account.js","mtime":1593517268972},{"path":"C:\\Users\\Neal Wang\\IdeaProjects\\rescue_web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Neal Wang\\IdeaProjects\\rescue_web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Neal Wang\\IdeaProjects\\rescue_web\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkID0gcmVxdWlyZSgiQzovVXNlcnMvTmVhbCBXYW5nL0lkZWFQcm9qZWN0cy9yZXNjdWVfd2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiKTsKCnZhciBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0ID0gcmVxdWlyZSgiQzovVXNlcnMvTmVhbCBXYW5nL0lkZWFQcm9qZWN0cy9yZXNjdWVfd2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdCIpOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CgpyZXF1aXJlKCJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiKTsKCnZhciBfYXN5bmNUb0dlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkM6L1VzZXJzL05lYWwgV2FuZy9JZGVhUHJvamVjdHMvcmVzY3VlX3dlYi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9hc3luY1RvR2VuZXJhdG9yIikpOwoKdmFyIF9hY2NvdW50ID0gcmVxdWlyZSgiQC9hcGkvYWNjb3VudCIpOwoKdmFyIF9hdXRoID0gcmVxdWlyZSgiQC91dGlscy9hdXRoIik7Cgp2YXIgX3JvdXRlciA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoIkAvcm91dGVyIikpOwoKdmFyIHN0YXRlID0gewogIHRva2VuOiAoMCwgX2F1dGguZ2V0VG9rZW4pKCksCiAgdXNlcjoge30sCiAgYWNjZXNzOiBudWxsCn07CnZhciBtdXRhdGlvbnMgPSB7CiAgU0VUX1RPS0VOOiBmdW5jdGlvbiBTRVRfVE9LRU4oc3RhdGUsIHRva2VuKSB7CiAgICBzdGF0ZS50b2tlbiA9IHRva2VuOwogIH0sCiAgU0VUX1VTRVI6IGZ1bmN0aW9uIFNFVF9VU0VSKHN0YXRlLCB1c2VyKSB7CiAgICBzdGF0ZS51c2VyID0gdXNlcjsKICB9LAogIFNFVF9BQ0NFU1M6IGZ1bmN0aW9uIFNFVF9BQ0NFU1Moc3RhdGUsIGFjY2VzcykgewogICAgc3RhdGUuYWNjZXNzID0gYWNjZXNzOwogIH0KfTsKdmFyIGFjdGlvbnMgPSB7CiAgLy8gdXNlciBsb2dpbgogIGxvZ2luOiBmdW5jdGlvbiBsb2dpbihfcmVmLCBsb2dpbk1vZGVsKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICB2YXIgdXNlcm5hbWUgPSBsb2dpbk1vZGVsLnVzZXJuYW1lLAogICAgICAgIHBhc3N3b3JkID0gbG9naW5Nb2RlbC5wYXNzd29yZDsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICgwLCBfYWNjb3VudC5sb2dpbikoewogICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZS50cmltKCksCiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgLy8g5a2Y5pS+dG9rZW7mlL7lhaVsb2NhbFN0b3JhZ2UKICAgICAgICBjb21taXQoJ1NFVF9UT0tFTicsIHJlc3BvbnNlLmRhdGEudG9rZW4pOwogICAgICAgIGNvbW1pdCgnU0VUX1VTRVInLCByZXNwb25zZS5kYXRhLnVzZXIpOwogICAgICAgICgwLCBfYXV0aC5zZXRUb2tlbikocmVzcG9uc2UuZGF0YS50b2tlbik7CiAgICAgICAgcmVzb2x2ZSgpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICB9KTsKICAgIH0pOwogIH0sCiAgLy8gZ2V0IHVzZXIgYWNjZXNzCiAgZ2V0QWNjZXNzOiBmdW5jdGlvbiBnZXRBY2Nlc3MoX3JlZjIpIHsKICAgIHZhciBjb21taXQgPSBfcmVmMi5jb21taXQ7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAoMCwgX2FjY291bnQuZ2V0QWNjZXNzKSgpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgdmFyIGFjY2VzcyA9IHJlc3BvbnNlLmRhdGEuYWNjZXNzOwoKICAgICAgICBpZiAoIWFjY2VzcykgewogICAgICAgICAgcmVqZWN0KCfor7fph43mlrDnmbvlvZXvvIEnKTsKICAgICAgICB9IC8vIOWwhmFjY2Vzc+acrOWcsOWtmOWCqAoKCiAgICAgICAgY29tbWl0KCdTRVRfQUNDRVNTJywgYWNjZXNzKTsKICAgICAgICByZXNvbHZlKHsKICAgICAgICAgIGFjY2VzczogYWNjZXNzCiAgICAgICAgfSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyB1c2VyIGxvZ291dAogIGxvZ291dDogZnVuY3Rpb24gbG9nb3V0KF9yZWYzKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjMuY29tbWl0LAogICAgICAgIHN0YXRlID0gX3JlZjMuc3RhdGU7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAoMCwgX2FjY291bnQubG9nb3V0KShzdGF0ZS50b2tlbikudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCAnJyk7CiAgICAgICAgY29tbWl0KCdTRVRfQUNDRVNTJywgbnVsbCk7CiAgICAgICAgKDAsIF9hdXRoLnJlbW92ZVRva2VuKSgpOwogICAgICAgICgwLCBfcm91dGVyLnJlc2V0Um91dGVyKSgpOwogICAgICAgIHJlc29sdmUoKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgfSk7CiAgICB9KTsKICB9LAogIC8vIHJlbW92ZSB0b2tlbgogIHJlc2V0VG9rZW46IGZ1bmN0aW9uIHJlc2V0VG9rZW4oX3JlZjQpIHsKICAgIHZhciBjb21taXQgPSBfcmVmNC5jb21taXQ7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCAnJyk7CiAgICAgIGNvbW1pdCgnU0VUX0FDQ0VTUycsIG51bGwpOwogICAgICAoMCwgX2F1dGgucmVtb3ZlVG9rZW4pKCk7CiAgICAgIHJlc29sdmUoKTsKICAgIH0pOwogIH0sCiAgLy8gZHluYW1pY2FsbHkgbW9kaWZ5IHBlcm1pc3Npb25zCiAgY2hhbmdlUm9sZXM6IGZ1bmN0aW9uIGNoYW5nZVJvbGVzKF9yZWY1LCByb2xlKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjUuY29tbWl0LAogICAgICAgIGRpc3BhdGNoID0gX3JlZjUuZGlzcGF0Y2g7CiAgICByZXR1cm4gbmV3IFByb21pc2UoIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcmVmNiA9ICgwLCBfYXN5bmNUb0dlbmVyYXRvcjIuZGVmYXVsdCkoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKHJlc29sdmUpIHsKICAgICAgICB2YXIgdG9rZW4sIF95aWVsZCRkaXNwYXRjaCwgYWNjZXNzLCBhY2Nlc3NSb3V0ZXM7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHRva2VuID0gcm9sZSArICctdG9rZW4nOwogICAgICAgICAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCB0b2tlbik7CiAgICAgICAgICAgICAgICAoMCwgX2F1dGguc2V0VG9rZW4pKHRva2VuKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgcmV0dXJuIGRpc3BhdGNoKCdnZXRBY2Nlc3MnKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgX3lpZWxkJGRpc3BhdGNoID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICAgIGFjY2VzcyA9IF95aWVsZCRkaXNwYXRjaC5hY2Nlc3M7CiAgICAgICAgICAgICAgICAoMCwgX3JvdXRlci5yZXNldFJvdXRlcikoKTsgLy8gZ2VuZXJhdGUgYWNjZXNzaWJsZSByb3V0ZXMgbWFwIGJhc2VkIG9uIGFjY2VzcwoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMDsKICAgICAgICAgICAgICAgIHJldHVybiBkaXNwYXRjaCgncGVybWlzc2lvbi9nZW5lcmF0ZVJvdXRlcycsIGFjY2VzcywgewogICAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgIGFjY2Vzc1JvdXRlcyA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICAgICAgLy8gZHluYW1pY2FsbHkgYWRkIGFjY2Vzc2libGUgcm91dGVzCiAgICAgICAgICAgICAgICBfcm91dGVyLmRlZmF1bHQuYWRkUm91dGVzKGFjY2Vzc1JvdXRlcyk7IC8vIHJlc2V0IHZpc2l0ZWQgdmlld3MgYW5kIGNhY2hlZCB2aWV3cwoKCiAgICAgICAgICAgICAgICBkaXNwYXRjaCgndGFnc1ZpZXcvZGVsQWxsVmlld3MnLCBudWxsLCB7CiAgICAgICAgICAgICAgICAgIHJvb3Q6IHRydWUKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmVzb2x2ZSgpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKTsKCiAgICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKICAgICAgICByZXR1cm4gX3JlZjYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfTsKICAgIH0oKSk7CiAgfQp9Owp2YXIgX2RlZmF1bHQgPSB7CiAgbmFtZXNwYWNlZDogdHJ1ZSwKICBzdGF0ZTogc3RhdGUsCiAgbXV0YXRpb25zOiBtdXRhdGlvbnMsCiAgYWN0aW9uczogYWN0aW9ucwp9OwpleHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDs="},{"version":3,"sources":["C:/Users/Neal Wang/IdeaProjects/rescue_web/src/store/modules/account.js"],"names":["state","token","user","access","mutations","SET_TOKEN","SET_USER","SET_ACCESS","actions","login","loginModel","commit","username","password","Promise","resolve","reject","trim","then","response","data","catch","error","getAccess","logout","resetToken","changeRoles","role","dispatch","root","accessRoutes","router","addRoutes","namespaced"],"mappings":"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","sourcesContent":["import { login, logout, getAccess } from '@/api/account'\r\nimport { getToken, setToken, removeToken } from '@/utils/auth'\r\nimport router, { resetRouter } from '@/router'\r\n\r\nconst state = {\r\n  token: getToken(),\r\n  user: {},\r\n  access: null\r\n}\r\n\r\nconst mutations = {\r\n  SET_TOKEN: (state, token) => {\r\n    state.token = token\r\n  },\r\n  SET_USER: (state, user) => {\r\n    state.user = user\r\n  },\r\n  SET_ACCESS: (state, access) => {\r\n    state.access = access\r\n  }\r\n}\r\n\r\nconst actions = {\r\n  // user login\r\n  login({ commit }, loginModel) {\r\n    const { username, password } = loginModel\r\n    return new Promise((resolve, reject) => {\r\n      login({ username: username.trim(), password: password }).then(response => {\r\n        // 存放token放入localStorage\r\n        commit('SET_TOKEN', response.data.token)\r\n        commit('SET_USER', response.data.user)\r\n        setToken(response.data.token)\r\n        resolve()\r\n      }).catch(error => {\r\n        reject(error)\r\n      })\r\n    })\r\n  },\r\n\r\n  // get user access\r\n  getAccess({ commit }) {\r\n    return new Promise((resolve, reject) => {\r\n      getAccess().then(response => {\r\n        const access = response.data.access\r\n        if (!access) {\r\n          reject('请重新登录！')\r\n        }\r\n\r\n        // 将access本地存储\r\n        commit('SET_ACCESS', access)\r\n        resolve({ access })\r\n      }).catch(error => {\r\n        reject(error)\r\n      })\r\n    })\r\n  },\r\n\r\n  // user logout\r\n  logout({ commit, state }) {\r\n    return new Promise((resolve, reject) => {\r\n      logout(state.token).then(() => {\r\n        commit('SET_TOKEN', '')\r\n        commit('SET_ACCESS', null)\r\n        removeToken()\r\n        resetRouter()\r\n        resolve()\r\n      }).catch(error => {\r\n        reject(error)\r\n      })\r\n    })\r\n  },\r\n\r\n  // remove token\r\n  resetToken({ commit }) {\r\n    return new Promise(resolve => {\r\n      commit('SET_TOKEN', '')\r\n      commit('SET_ACCESS', null)\r\n      removeToken()\r\n      resolve()\r\n    })\r\n  },\r\n\r\n  // dynamically modify permissions\r\n  changeRoles({ commit, dispatch }, role) {\r\n    return new Promise(async resolve => {\r\n      const token = role + '-token'\r\n\r\n      commit('SET_TOKEN', token)\r\n      setToken(token)\r\n\r\n      const { access } = await dispatch('getAccess')\r\n\r\n      resetRouter()\r\n\r\n      // generate accessible routes map based on access\r\n      const accessRoutes = await dispatch('permission/generateRoutes', access, { root: true })\r\n\r\n      // dynamically add accessible routes\r\n      router.addRoutes(accessRoutes)\r\n\r\n      // reset visited views and cached views\r\n      dispatch('tagsView/delAllViews', null, { root: true })\r\n\r\n      resolve()\r\n    })\r\n  }\r\n}\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  mutations,\r\n  actions\r\n}\r\n"]}]}